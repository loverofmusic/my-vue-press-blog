(window.webpackJsonp=window.webpackJsonp||[]).push([[104],{474:function(t,s,v){"use strict";v.r(s);var _=v(5),a=Object(_.a)({},(function(){var t=this,s=t.$createElement,v=t._self._c||s;return v("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[v("h3",{attrs:{id:"前端性能优化"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#前端性能优化"}},[t._v("#")]),t._v(" 前端性能优化")]),t._v(" "),v("ul",[v("li",[t._v("从输入url到页面展现发生了什么")]),t._v(" "),v("li",[t._v("网络端优化")]),t._v(" "),v("li",[t._v("浏览器端优化")])]),t._v(" "),v("p",[t._v("宏观：（以下这些过程所有加起来的时间 就是从输入url到页面展现的时间）")]),t._v(" "),v("ul",[v("li",[t._v("DNS")]),t._v(" "),v("li",[t._v("TCP")]),t._v(" "),v("li",[t._v("HTTP/SSL")]),t._v(" "),v("li",[t._v("响应解析（SPA/SSR）")]),t._v(" "),v("li",[t._v("浏览器渲染（how browser works）")])]),t._v(" "),v("p",[t._v("思路："),v("br"),t._v("\nurl =》 dns获取ip =》 建立tcp =》 解析响应 =》 浏览器渲染 "),v("br"),t._v("\nHTTP,FTP,SSH    |       DNS"),v("br"),t._v("\nTCP(可靠协议)    |    UDP(不可靠，发出去基本就不管了)"),v("br"),t._v("\nIP寻址"),v("br")]),t._v(" "),v("p",[t._v("带来的反思：")]),t._v(" "),v("ol",[v("li",[t._v("分片")]),t._v(" "),v("li",[t._v("慢启动")])]),t._v(" "),v("p",[t._v("处理大数据场景下，都可以借鉴tcp这个优化的方法")]),t._v(" "),v("p",[t._v("基于tcp之上的http协议，如果你只是单纯的发送一个数据，可以不走http，你可以基于tcp之上自己定制client server")]),t._v(" "),v("p",[t._v("http基于tcp，定制了解析的逻辑")]),t._v(" "),v("p",[t._v("method 地址 http/版本"),v("br"),t._v("\nkey： value"),v("br"),t._v("\nkey： value"),v("br")]),t._v(" "),v("p",[t._v("body"),v("br")]),t._v(" "),v("p",[t._v("GET / HTTP/1.1"),v("br"),t._v("\nhost"),v("br"),t._v("\ncookie"),v("br")]),t._v(" "),v("p",[t._v("静态资源的缓存 前端强相关， 工程化")]),t._v(" "),v("p",[t._v("前端到底是如何上线代码的"),v("br")]),t._v(" "),v("p",[t._v("从前：")]),t._v(" "),v("ul",[v("li",[t._v("小应用开发完毕， html，css，js 丢nginx就ok")]),t._v(" "),v("li",[t._v("开发完毕，模版都在server（smarty，jsp），静态资源上cdn")])]),t._v(" "),v("p",[t._v("如今：")]),t._v(" "),v("ul",[v("li",[t._v("webpack工程化：静态资源contenthash 更好的利用缓存")])]),t._v(" "),v("ul",[v("li",[t._v("a_hash.js a_hash2.js a_hash3.js")]),t._v(" "),v("li",[t._v("a?_v=1.0")]),t._v(" "),v("li",[t._v("a?_t=时间戳")]),t._v(" "),v("li",[t._v("a?_g=经纬度")])]),t._v(" "),v("p",[t._v("文件冗余")]),t._v(" "),v("p",[t._v("浏览器缓存的逻辑 强缓存 协商缓存")]),t._v(" "),v("p",[t._v("响应")]),t._v(" "),v("p",[t._v("响应报文返回")]),t._v(" "),v("p",[t._v("html之后，怎么处理")]),t._v(" "),v("ul",[v("li",[t._v("spa返回的是一个空的html逻辑都在js里（vue react默认的）")]),t._v(" "),v("li",[t._v("同构（首屏渲染速度 + SEO）(NUXT NEXT)\n"),v("ul",[v("li",[t._v("需要node环境 应用首屏 现在node里执行渲染一下 返回浏览器")]),t._v(" "),v("li",[t._v("后续就是单页的逻辑")])])])]),t._v(" "),v("p",[t._v("（component， 数据管理，router）两个入口 entry_client entry_server , build 两个包， 给首屏和后续使用")]),t._v(" "),v("p",[t._v("浏览器解析 html css js")]),t._v(" "),v("ol",[v("li",[t._v("解析html（AST）dom tree --dom层级不要太多")]),t._v(" "),v("li",[t._v("解析css css-tree --css选择器优化")]),t._v(" "),v("li",[t._v("合成render tree")]),t._v(" "),v("li",[t._v("浏览器调用操作系统渲染")])]),t._v(" "),v("p",[t._v("重绘回流")]),t._v(" "),v("p",[t._v("从输入url到页面渲染的时间怎么变短，每一步都有对应的参数指标")]),t._v(" "),v("p",[t._v("简单粗暴的优化策略")]),t._v(" "),v("ul",[v("li",[t._v("文件加载更少")]),t._v(" "),v("li",[t._v("代码执行更少\n"),v("ul",[v("li",[t._v("节流防抖")]),t._v(" "),v("li",[t._v("按需执行")]),t._v(" "),v("li",[t._v("回流重绘")]),t._v(" "),v("li",[t._v("框架优化（比如vue3的静态标记）")]),t._v(" "),v("li",[t._v("html css js")])])])]),t._v(" "),v("p",[t._v("缓存 CDN 图片优化 静态文件优化 浏览器优化 文件合并压缩\n图片：")]),t._v(" "),v("ul",[v("li",[t._v("JPEG/JPG")]),t._v(" "),v("li",[t._v("PNG （色彩丰富的 logo 透明）")]),t._v(" "),v("li",[t._v("GIF （体积可以很小 占位符 做统计）")]),t._v(" "),v("li",[t._v("WEBP(优化的体积 色彩都是最好的，但是有兼容性问题 手机基本都可以)")]),t._v(" "),v("li",[t._v("压缩工具 ，不同尺寸")]),t._v(" "),v("li",[t._v("渐进加载（先加载占位 =》 低像素 =》 实际）， lazyload懒加载")])]),t._v(" "),v("p",[t._v("cdn最合适的方式 就是通过url来定制 图片格式和大小")]),t._v(" "),v("p",[t._v("为了解决spa首屏和seo:")]),t._v(" "),v("ul",[v("li",[t._v("prerenderer")]),t._v(" "),v("li",[t._v("静态化")]),t._v(" "),v("li",[t._v("同构（ ssr + spa ）综合体")])]),t._v(" "),v("h3",{attrs:{id:"前端性能监控"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#前端性能监控"}},[t._v("#")]),t._v(" 前端性能监控")]),t._v(" "),v("ul",[v("li",[v("p",[t._v("前端性能指标分析")]),t._v(" "),v("ul",[v("li",[t._v("FP首次绘制")]),t._v(" "),v("li",[t._v("FCP首次内容绘制")]),t._v(" "),v("li",[t._v("FMP首次有意义绘制")]),t._v(" "),v("li",[t._v("TTI可交互时间")])])]),t._v(" "),v("li",[v("p",[t._v("关键性能指标统计")])]),t._v(" "),v("li",[v("p",[t._v("数据上报方式")])]),t._v(" "),v("li",[v("p",[t._v("性能分析工具")])])]),t._v(" "),v("div",{staticClass:"language-js line-numbers-mode"},[v("pre",{pre:!0,attrs:{class:"language-js"}},[v("code",[v("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" times "),v("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),v("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" t "),v("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" performance"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),v("span",{pre:!0,attrs:{class:"token function"}},[t._v("getEntriesByType")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),v("span",{pre:!0,attrs:{class:"token string"}},[t._v("'navigation'")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),v("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\ntimes"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dns "),v("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" t"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("domainLookupEnd "),v("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" t"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("domainLookupStart\ntimes"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("reqTime "),v("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" t"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("responseEnd "),v("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" t"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("responseStart\ntimes"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tcp "),v("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" t"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("connectEnd "),v("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" t"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("connectStart\ntimes"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("blankTime "),v("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" t"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("domInteractive "),v("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" t"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("fetchStart\ntimes"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("domParse "),v("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" t"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("domComplete "),v("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" t"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("domInteractive\n\nconsole"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),v("span",{pre:!0,attrs:{class:"token function"}},[t._v("table")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("t"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nconsole"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),v("span",{pre:!0,attrs:{class:"token function"}},[t._v("table")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("times"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),v("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//可以算出的指标都是硬性的")]),t._v("\n"),v("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 和交互相关的，需要别的方式来统计FMP--1s之内首屏fmp能出来的概率达到85%以上，是对用户相对比较好的指标")]),t._v("\n")])]),t._v(" "),v("div",{staticClass:"line-numbers-wrapper"},[v("span",{staticClass:"line-number"},[t._v("1")]),v("br"),v("span",{staticClass:"line-number"},[t._v("2")]),v("br"),v("span",{staticClass:"line-number"},[t._v("3")]),v("br"),v("span",{staticClass:"line-number"},[t._v("4")]),v("br"),v("span",{staticClass:"line-number"},[t._v("5")]),v("br"),v("span",{staticClass:"line-number"},[t._v("6")]),v("br"),v("span",{staticClass:"line-number"},[t._v("7")]),v("br"),v("span",{staticClass:"line-number"},[t._v("8")]),v("br"),v("span",{staticClass:"line-number"},[t._v("9")]),v("br"),v("span",{staticClass:"line-number"},[t._v("10")]),v("br"),v("span",{staticClass:"line-number"},[t._v("11")]),v("br"),v("span",{staticClass:"line-number"},[t._v("12")]),v("br"),v("span",{staticClass:"line-number"},[t._v("13")]),v("br")])]),v("p",[t._v("FMP：")]),t._v(" "),v("ol",[v("li",[t._v("页面进入使用mutationObserver")]),t._v(" "),v("li",[t._v("对变化的dom打上标记")]),t._v(" "),v("li",[t._v("文档的load触发")]),t._v(" "),v("li",[t._v("遍历dom tree")]),t._v(" "),v("li",[t._v("根据元素的可视区域，计算元素的权重")]),t._v(" "),v("li",[t._v("遍历父元素，对比合并")]),t._v(" "),v("li",[t._v("get一下权重最高的")]),t._v(" "),v("li",[t._v("判断他是否加载完毕")])]),t._v(" "),v("ul",[v("li",[t._v("是不是img video audio这种资源标签 资源加载时间")]),t._v(" "),v("li",[t._v("只是单纯的dom 时间-dom变化")])]),t._v(" "),v("ol",{attrs:{start:"9"}},[v("li",[t._v("算出fmp")])]),t._v(" "),v("p",[t._v("简单粗暴的计算：\nmutationObserver首屏load出来80% 就算")]),t._v(" "),v("p",[t._v("只要能快一点都算优化")]),t._v(" "),v("ol",[v("li",[t._v("代码优化")]),t._v(" "),v("li",[t._v("研发优化 基础建设")]),t._v(" "),v("li",[t._v("开发环境优化（vite snowpack）")])]),t._v(" "),v("h3",{attrs:{id:"指导思想-原则方向"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#指导思想-原则方向"}},[t._v("#")]),t._v(" 指导思想/原则方向")]),t._v(" "),v("blockquote",[v("p",[t._v("使用内存，缓存或其他方法"),v("br"),t._v("\n减少 CPU 计算量， 减少网络加载耗时")])]),t._v(" "),v("blockquote",[v("p",[t._v("空间换时间")])]),t._v(" "),v("blockquote",[v("p",[t._v("算法中 => 降低 时间复杂度"),v("br"),t._v("\nChrome 浏览器的快 => 每个标签页一个进程")])]),t._v(" "),v("ul",[v("li",[v("p",[t._v("让加载更快（ 下载文件更快，从30s变成3s ）")]),t._v(" "),v("ul",[v("li",[t._v("减少资源体积：压缩")]),t._v(" "),v("li",[t._v("减少访问次数：合并， SSR服务端渲染， 缓存")]),t._v(" "),v("li",[t._v("使用更快的网络：CDN")])])]),t._v(" "),v("li",[v("p",[t._v("让渲染更快 （ 让代码逻辑更加合理，没有重复的渲染操作，没有多余的渲染操作，没有无用功，没有等待，让渲染更快，至少在同一时间内让用户看到的更快 ）")]),t._v(" "),v("ul",[v("li",[t._v("CSS 放在 head，JS 放在 body 最下面")]),t._v(" "),v("li",[t._v("尽早开始执行JS，用 DOMContentLoaded 触发")]),t._v(" "),v("li",[t._v("懒加载（图片懒加载，上滑加载更多）")]),t._v(" "),v("li",[t._v("对 DOM 查询进行缓存")]),t._v(" "),v("li",[t._v("频繁 DOM 操作，合并到一起插入 DOM 结构")]),t._v(" "),v("li",[t._v("节流（throttle） 防抖（debounce）")])])])]),t._v(" "),v("h3",{attrs:{id:"缓存（提高命中率，只让新的重新加载）"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#缓存（提高命中率，只让新的重新加载）"}},[t._v("#")]),t._v(" 缓存（提高命中率，只让新的重新加载）")]),t._v(" "),v("ul",[v("li",[t._v("静态资源加 hash 后缀，根据文件内容计算 hash")]),t._v(" "),v("li",[t._v("文件内容不变，则 hash 不变， 则URL不变")]),t._v(" "),v("li",[t._v("URL和文件不变，则会自动触发 http 缓存机制，返回 304（CDN完全满足304）")])]),t._v(" "),v("h3",{attrs:{id:"ssr服务端渲染"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#ssr服务端渲染"}},[t._v("#")]),t._v(" SSR服务端渲染")]),t._v(" "),v("ul",[v("li",[t._v("将网页和数据一起加载，一起渲染，一遍结束")]),t._v(" "),v("li",[t._v("非SSR（前后端分离）：先加载网页，再加载网页，再加载数据，再渲染数据")])])])}),[],!1,null,null,null);s.default=a.exports}}]);